function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function report_index233(a,b,c,d){sessionStorage.setItem("month",d),sessionStorage.setItem("year",c),sendAjax({url:"fire/on_work/getWorkListByCondition",data:{uid:b,year:c,month:d},callback:function(c){var d,e,f,g,h,i,j,k,l;if(c.code="s_ok"){for(layer.msg("查询成功"),d=c.var,e={language:"CH",showLunarCalendar:!0,showHoliday:!1,showFestival:!1,showLunarFestival:!1,showSolarTerm:!1,showMark:!0,time:!0,timeRange:{startYear:2e3,endYear:2049},mark:{}},sessionStorage.setItem("kquserName",b),sessionStorage.setItem("kqusertel",a),$(".calendar_fire").show(),$("#calendar").show(),sendAjax({url:"fire/level/findLevelByCondition",data:{current_page:1,per_page:100,apply_tel:a},callback:function(a){var b,c,d,f,g,h,i;if(a=a.var.data,""!=a)for(b=0;b<a.length;b++)c=a[b].apply_start_time.substr(0,10),d=a[b].apply_start_time.substr(0,10),f=a[b].apply_start_time.substr(0,10)+"_",g=a[b].apply_reason,h=a[b].apply_start_time.substr(0,10)+"__",i=a[b].apply_end_time.substr(0,10),e.mark[c]=d,e.mark[f]=g,e.mark[h]=i}}),f=0;f<d.length;f++)g=d[f].record_date,h=d[f].record_time,i=d[f].record_date+"_",j=d[f].address,k=d[f].record_date+"__",l=d[f].latlng,e.mark[g]=h,e.mark[i]=j,e.mark[k]=l;new SimpleCalendar("#calendar",e)}else layer.alert("网络不好，请刷新试试！",{skin:"layui-layer-molv",closeBtn:0,anim:4,btnAlign:"c"})}})}var options_this,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},_createClass=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),LunarHelp=function(){function a(b,c,d){var e,f,g,h,i,j;for(_classCallCheck(this,a),this.lunarInfo=new Array(19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448),this.nStr1=new Array("日","一","二","三","四","五","六","七","八","九","十"),this.nStr2=new Array("初","十","廿","三"),e=new Date(parseInt(b),parseInt(c)-1,parseInt(d)),g=0,h=0,i=new Date(1900,0,31),j=(e-i)/864e5,f=1900;2050>f&&j-this.lYearDays(f)>0;f++)j-=this.lYearDays(f);for(this.year=f,g=this.leapMonth(f),this.isLeap=!1,f=1;13>f&&j>0;f++)g>0&&f==g+1&&0==this.isLeap?(--f,h=this.leapDays(this.year)):h=this.monthDays(this.year,f),1==this.isLeap&&f==g+1&&(this.isLeap=!1),j-=h;0==j&&g>0&&f==g+1&&(this.isLeap?this.isLeap=!1:(this.isLeap=!0,--f)),0>j&&(j+=h,--f),this.month=f,this.day=j+1}return _createClass(a,[{key:"lYearDays",value:function(a){var b,c=0;for(b=32768;b>8;b>>=1)c+=this.lunarInfo[a-1900]&b?30:29;return c+this.leapDays(a)}},{key:"leapDays",value:function(a){return this.leapMonth(a)?65536&this.lunarInfo[a-1900]?30:29:0}},{key:"leapMonth",value:function(a){return 15&this.lunarInfo[a-1900]}},{key:"monthDays",value:function(a,b){return this.lunarInfo[a-1900]&65536>>b?30:29}},{key:"cDay",value:function(a){var b;switch(a){case 10:b="初十";break;case 20:b="二十";break;case 30:b="三十";break;default:b=this.nStr2[Math.floor(a/10)],b+=this.nStr1[a%10]}return b}},{key:"cMonth",value:function(a){var b;switch(a){case 1:b="正月";break;case 2:b="二月";break;case 3:b="三月";break;case 4:b="四月";break;case 5:b="五月";break;case 6:b="六月";break;case 7:b="七月";break;case 8:b="八月";break;case 9:b="九月";break;case 10:b="十月";break;case 11:b="十一月";break;case 12:b="十二月"}return b}},{key:"getLunarDay",value:function(){return cMonth(this.month)+cDay(this.day)}},{key:"getLunarDayName",value:function(){return 1==this.day?this.cMonth(this.month):this.cDay(this.day)}},{key:"getLunarDayNum",value:function(){return{day:this.day,month:this.month}}}]),a}(),SimpleCalendar=function(){function a(b,c){_classCallCheck(this,a),this._defaultOptions={width:"500px",height:"600px",language:"CH",showLunarCalendar:!0,showHoliday:!0,showFestival:!0,showLunarFestival:!0,showSolarTerm:!0,showMark:!0,timeRange:{startYear:1900,endYear:2049},timeZone:"",theme:{changeAble:!1,weeks:{backgroundColor:"#FBEC9C",fontColor:"#4A4A4A",fontSize:"20px"},days:{backgroundColor:"#ffffff",fontColor:"#565555",fontSize:"24px"},todaycolor:"orange",activeSelectColor:"orange",invalidDays:"#C1C0C0"}},this.container=document.querySelector(b),this._defaultOptions.width=this.container.style.offsetWidth,this._defaultOptions.height=this.container.style.offsetHeight,this._options=this.optionAssign(this._defaultOptions,c),this.create()}return _createClass(a,[{key:"optionAssign",value:function(a,b){for(var c in b)a[c]="object"!==_typeof(a[c])?b[c]:this.optionAssign(a[c],b[c]);return a}},{key:"create",value:function(){var b,c,d,e,f,g,h,i,a=this.container;for(a.innerHTML='<div class="sc-header_top"> </div><div class="sc-header"> </div> <div class="sc-body"> </div>',a.style.width=this._options.width,a.style.height=this._options.height,a.className="sc-calendar",b=a.querySelector(".sc-header_top"),c=a.querySelector(".sc-header"),d=a.querySelector(".sc-body"),b.innerHTML=b.innerHTML+'<div class="sc-header_top">考勤记录<span class="layui-layer-setwin"><a class="layui-layer-ico layui-layer-close layui-layer-close1" href="javascript:;"></a></span></div>',c.innerHTML=c.innerHTML+'<div class="sc-actions">'+'      <div class="sc-yleft">'+"        &lsaquo;</div>"+'      <select class="sc-select-year" name="">'+"      </select>"+'      <div class="sc-yright">&rsaquo;</div>'+"  </div>",c.innerHTML=c.innerHTML+'<div class="sc-actions">'+'    <div class="sc-mleft">'+"      &lsaquo;</div>"+'    <select class="sc-select-month" name="">'+"    </select>"+'    <div class="sc-mright">&rsaquo;</div>'+"</div>",c.innerHTML=c.innerHTML+'<div class="sc-actions"><span class="sc-time"></span></div>',d.innerHTML=' <div class="sc-week"> </div> <div class="sc-days"> </div>',e=d.querySelector(".sc-week"),f=d.querySelector(".sc-days"),g=0;7>g;g++)e.innerHTML=e.innerHTML+'<div class="sc-week-item"></div>';for(g=0;42>g;g++)f.innerHTML=f.innerHTML+'<div class="sc-item"><div class="day"></div><div class="lunar-day"></div></div>';h=sessionStorage.getItem("year"),i=sessionStorage.getItem("month"),this.updateSelect(h,i),this.update(i,h),self.setInterval("SimpleCalendar.timeupdate()",200)}},{key:"update",value:function(){var a=arguments.length<=0||void 0===arguments[0]?this.tmonth:arguments[0],b=arguments.length<=1||void 0===arguments[1]?this.tyear:arguments[1];this.updateSize(),this.updateWeek(),this.addData(b,a),this.updateHoliday(b,a),this.updateMark(b,a),this.updateFestival(b,a),this.updateEvent(),this.updateTheme(this._options.theme)}},{key:"updateSize",value:function(){var c,d,e,a=arguments.length<=0||void 0===arguments[0]?this._options.width:arguments[0],b=arguments.length<=1||void 0===arguments[1]?this._options.height:arguments[1];this._options.width=a,this._options.height=b,this.container.style.width=a,this.container.style.height=b,parseInt(a)<500?(c=this.arrayfrom(this.container.querySelectorAll(".sc-actions")),c.forEach(function(a){a.classList.add("sc-actions-big")})):(c=this.arrayfrom(this.container.querySelectorAll(".sc-actions")),c.forEach(function(a){a.classList.remove("sc-actions-big")})),parseInt(b)<400?(d=this.arrayfrom(this.container.querySelectorAll(".sc-item")),e=this.arrayfrom(this.container.querySelectorAll(".sc-week-item")),d.forEach(function(a){a.querySelector(".day").classList.add("sc-item-small")}),e.forEach(function(a){a.classList.add("sc-item-small")})):(d=this.arrayfrom(this.container.querySelectorAll(".sc-item")),e=this.arrayfrom(this.container.querySelectorAll(".sc-week-item")),d.forEach(function(a){a.querySelector(".day").classList.remove("sc-item-small")}),e.forEach(function(a){a.classList.remove("sc-item-small")}))}},{key:"updateSelect",value:function(a,b){var e,f,c=this.container.querySelector(".sc-select-year"),d=this.container.querySelector(".sc-select-month");for(c.innerHTML="",e=this._options.timeRange.startYear;e<this._options.timeRange.endYear+1;e++)c.innerHTML+='<option value="'+e+'">'+e+"</option>";for(d.innerHTML="",e=0;12>e;e++)f=this.languageData["months_"+this._options.language],d.innerHTML+='<option value="'+(e+1)+'">'+f[e]+"</option>";c.value=a,d.value=b}},{key:"updateWeek",value:function(){var a=this.arrayfrom(this.container.querySelectorAll(".sc-week-item")),b=this.languageData["days_"+this._options.language];b||console.error("language error!"),a.forEach(function(a,c){a.innerHTML=b[c]})}},{key:"addData",value:function(a,b){function u(a){var c,d,b='<div id="allTextByOption"></div>';for(layer.confirm(""+b,{title:"本月打卡信息",type:1,closeBtn:1,anim:2,skin:"layui-layer-molv",shadeClose:!0,btnAlign:"c",area:["650px","450px;"]}),c=0;c<a.length;c++)d='<ul class="ulText" style="width:100%;padding:20px;text-align:left;"><li><label>打卡时间：</label><span id="textData">'+a[c].data+"</span></li>"+'<li><label>地址：</label><span id="textPos">'+a[c].position+"</span></li>"+'<li><label>坐标：</label><input class="enter_map" type="button" value="回显位置" onclick="echo_map(\''+a[c].location+"',"+"1"+")\" style='width: 65px;border:none;background: #addc9d;color: #fff;'>"+"</li></ul>",$("#allTextByOption").append(d)}var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,c=this.arrayfrom(this.container.querySelectorAll(".sc-item")),d=new Date(a,b-1,1),e=d.getDay();for(0==e&&(e=7),f=new Date(Date.parse(d)-1e3*3600*24*(e-1)),g=[],10>b&&(b="0"+b),h=0;42>h;h++){if(c[h].className="sc-item",i=new Date(Date.parse(f)+1e3*3600*24*h),j=i.getFullYear(),k=i.getDate(),10>k&&(k="0"+k),l=i.getMonth()+1,10>l&&(l="0"+l),l!=b&&(c[h].classList.add("sc-othermenth"),g.push(c[h])),c[h].querySelector(".day").innerHTML=k,this._options.showLunarCalendar){for(m=new Date((new Date).setHours(0,0,0,0))/1e3,n=Math.floor(m/86400),o=Math.floor(i.getTime()/864e5),p=[],q=this,r=0;r<q._options.mark.length;r++)s=Math.floor(new Date(this._options.mark[r].data).getTime()/864e5),o>n?(c[h].querySelector(".lunar-day").innerHTML="",c[h].style.backgroundColor="#fff",c[h].style.color="#565555"):s==o+1?(p.push(h),c[h].addEventListener("click",function(){u(q._options.mark)})):(c[h].querySelector(".lunar-day").innerHTML="未打卡",c[h].style.backgroundColor="#FF8A8A");for(t=0;t<p.length;p++)c[p].querySelector(".lunar-day").innerHTML="已打卡",c[p].style.backgroundColor="#14e16b",c[p].style.color="#565555"}else c[h].querySelector(".lunar-day").innerHTML="",c[h].classList.add("item-nolunar");this.tyear==j&&this.tday==k&&this.tmonth==l&&(this.selectDay=c[h],c[h].classList.add("sc-today"))}number_days=c.length-g.length}},{key:"updateMark",value:function(a,b){var d,e,f,g,h,i,c=this._options;c.showMark&&(d=this.arrayfrom(this.container.querySelectorAll(".sc-item")),e=b-1,f=c.mark,f&&(g=[],d.forEach(function(b){var h,d=+b.querySelector(".day").innerHTML;1==d&&e++,10>e&&(h="0"+e.toString()),10>d&&(d="0"+d.toString()),f[a+"-"+h+"-"+d]?(g.push(a+"-"+h+"-"+d),b.classList.add("sc-mark"),b.querySelector(".lunar-day").innerHTML="<span>"+f[a+"-"+h+"-"+d]+'</span><br><span class="lunar-day_two" data-map="'+f[a+"-"+h+"-"+d+"__"]+'"></span>'):(b.classList.remove("sc-mark"),b.title=""),f[a+"-"+h+"-"+d+"_"]?b.querySelector(".lunar-day_two").innerHTML='<i class="icon-map-marker"></i>'+f[a+"-"+h+"-"+d+"_"]:(b.classList.remove("sc-mark"),b.title="")}),h=g.length,i=number_days-h,$("#has_clock").html(h+"次"),$("#not_clock").html(i+"次")))}},{key:"updateFestival",value:function(a,b){var c=this._options,d=this.arrayfrom(this.container.querySelectorAll(".sc-item")),e=b-1,f=this.languageData["feativals_"+this._options.language],g=this.languageData["lunarFeatival_"+this._options.language],h=this.languageData["solarTerm"];f||console.error("language error!"),d.forEach(function(b){var j,i=+b.querySelector(".day").innerHTML;1==i&&e++,c.showSolarTerm&&h[e+"-"+i]&&(b.querySelector(".lunar-day").innerHTML=h[e+"-"+i],b.classList.add("sc-festival")),c.showFestival&&f[e+"-"+i]&&(b.querySelector(".lunar-day").innerHTML=f[e+"-"+i],b.classList.add("sc-festival")),g&&c.showLunarFestival&&(j=new LunarHelp(a,e,i).getLunarDayNum(),g[j.month+"-"+j.day]&&(b.querySelector(".lunar-day").innerHTML=g[j.month+"-"+j.day],b.classList.add("sc-festival")))})}},{key:"updateHoliday",value:function(a,b){var d,e,f,c=this._options;c.showHoliday&&(d=this.arrayfrom(this.container.querySelectorAll(".sc-item")),e=b-1,f=this.languageData.vocation["data_"+a],f&&d.forEach(function(a){var c=+a.querySelector(".day").innerHTML;1==c&&e++,f.indexOf(e+"-"+c)>0&&a.classList.add("sc-vocation")}))}},{key:"updateTheme",value:function(a){var b,c,d,e;this._options.theme.changeAble&&(b=a.days,c=a.weeks,d=this.arrayfrom(this.container.querySelectorAll(".sc-week-item")),e=this.arrayfrom(this.container.querySelectorAll(".sc-item")),d.forEach(function(a){a.style.backgroundColor=c.backgroundColor,a.style.fontSize=c.fontSize,a.style.color=c.fontColor}),e.forEach(function(c){c.classList.contains("sc-today")?c.style.backgroundColor=a.todaycolor:(c.style.backgroundColor=b.backgroundColor,c.querySelector(".day").style.color=b.fontColor),c.querySelector(".day").style.fontSize=b.fontSize}),e.forEach(function(b){b.onmouseover=function(){this.style.borderColor=a.activeSelectColor,this.style.borderWidth="1px"},b.onmouseout=function(){this.style.borderColor="#F1EBE4",this.style.borderWidth="0 0 1px 1px"}}))}},{key:"updateEvent",value:function(){var d,e,f,g,a=this.arrayfrom(this.container.querySelectorAll(".sc-item")),b=this.container,c=this;a.forEach(function(a){a.onmouseover=function(){this.classList.add("sc-active-day")},a.onmouseout=function(){this.classList.remove("sc-active-day")},a.onclick=function(){c.selectDay=a;var d=b.querySelector(".sc-selected");d&&d.classList.remove("sc-selected"),this.classList.add("sc-selected")}}),d=sessionStorage.getItem("kquserName"),e=sessionStorage.getItem("kqusertel"),f=b.querySelector(".sc-select-year"),g=b.querySelector(".sc-select-month"),f.onchange=function(){var f,a=g.value,b=this.value;c.update(a,b),f=c,report_index233(e,d,b,a,f)},g.onchange=function(){var g,a=f.value,b=this.value;c.update(b,a),g=c,report_index233(e,d,a,b,g)},b.querySelector(".sc-yright"),b.querySelector(".sc-yleft"),b.querySelector(".sc-mright"),b.querySelector(".sc-mleft")}},{key:"addMark",value:function(a,b){this._options.mark[a]=b}},{key:"getSelectedDay",value:function(){var a=this.container.querySelector(".sc-select-year").value,b=this.container.querySelector(".sc-select-month").value,c=this.selectDay.querySelector(".day").innerHTML;return new Date(a,b-1,c)}},{key:"setLenguage",value:function(a){var b,c;this._options.language=a,b=this.container.querySelector(".sc-select-year"),c=this.container.querySelector(".sc-select-month"),this.updateSelect(b.value,c.value),this.update()}},{key:"showFestival",value:function(a){this._options.showFestival=a,this.update()}},{key:"showHoliday",value:function(a){this._options.showHoliday=a,this.update()}},{key:"showSolarTerm",value:function(a){this._options.showSolarTerm=a,this.update()}},{key:"showLunarFestival",value:function(a){this._options.showLunarFestival=a,this.update()}},{key:"showLunarCalendar",value:function(a){this._options.showLunarCalendar=a,this.update()}},{key:"showMark",value:function(a){this._options.showMark=a,this.update()}},{key:"arrayfrom",value:function(a){var b=[];return[].forEach.call(a,function(a){b.push(a)}),b}}]),a}();SimpleCalendar.timeupdate=function(){var a=document.querySelectorAll(".sc-time"),b=new Date,c=b.getHours(),d=b.getMinutes(),e=b.getSeconds();10>c&&(c="0"+c),10>d&&(d="0"+d),10>e&&(e="0"+e),[].forEach.call(a,function(a){a.innerHTML="时间："+c+":"+d+":"+e})},SimpleCalendar.prototype.languageData={feativals_CH:{"1-1":"元旦","2-14":"情人节","3-8":"妇女节","3-12":"植树节","4-1":"愚人节","4-22":"地球日","5-1":"劳动节","5-4":"青年节","6-1":"儿童节","7-1":"建党节","8-1":"建军节","9-10":"教师节","10-1":"国庆节","12-25":"圣诞节"},feativals_EN:{"1-1":"new year’s day","2-14":"Saint Valentine's Day","3-8":"international women’s day","3-12":"Arbor Day","4-1":"April Fool's Day","4-22":"Earth Day","5-1":"international labour day","5-4":"Chinese Youth Day","6-1":"Children's Day","7-1":"The party's Day","8-1":"the Army's Day","9-10":"Teachers' Day","10-1":"National Day","12-25":"Christmas Day"},lunarFeatival_CH:{"1-1":"春节","2-2":"龙抬头","1-15":"元宵节","4-4":"寒食节","4-5":"清明节","5-5":"端午节","8-15":"中秋节","9-9":"重阳节","12-30":"除夕"},solarTerm:{"2-3":"立春","5-5":"立夏","8-7":"立秋","11-7":"立冬","2-18":"雨水","5-20":"小满","8-22":"处暑","11-22":"小雪","3-5":"惊蛰","6-5":"芒种","9-7":"白露","12-6":"大雪","3-20":"春分","6-21":"夏至","9-22":"秋分","12-21":"冬至","4-4":"清明","7-6":"小暑","10-8":"寒露","1-5":"小寒","4-19":"谷雨","7-22":"大暑","10-23":"霜降","1-20":"大寒"},days_EN:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],days_CH:["一","二","三","四","五","六","日"],months_EN:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months_CH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],vocation:{data_2016:["1-1","1-2","1-3","2-7","2-8","2-9","2-10","2-11","2-12","2-13","4-2","4-3","4-4","4-30","5-1","5-2","6-9","6-10","6-11","9-15","9-16","9-17",,"10-1","10-2","10-3","10-4","10-5","10-6","10-7"]}},SimpleCalendar.prototype.tyear=(new Date).getFullYear(),SimpleCalendar.prototype.tmonth=(new Date).getMonth()+1,SimpleCalendar.prototype.tday=(new Date).getDate(),$("#calendar").on("click",".lunar-day_two",function(){var a=$(this).attr("data-map").split(";");a.pop(),layer.open({type:1,skin:"layui-layer-molv",closeBtn:1,anim:2,btnAlign:"c",area:["600px","440px;"],title:"地图信息",shadeClose:!0,content:'<div id="container" style="width:600px;height:400px"></div>',success:function(){var d,e,b=new AMap.Map("container",{resizeEnable:!0,zoom:12}),c=new AMap.MapType({defaultType:1,showRoad:!0});for(b.addControl(c),d=0;d<a.length;d++)e=new AMap.Marker({icon:"http://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:JSON.parse("["+String(a[d])+"]"),map:b}),e.setMap(b),b.setZoomAndCenter(17,JSON.parse("["+String(a[d])+"]")),b.setFitView(10)}})});